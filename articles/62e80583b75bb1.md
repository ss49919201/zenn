---
title: "LocalStackã§Amazon SESã‚’å‹•ã‹ã—ã¦ã¿ã‚‹"
emoji: "ğŸ’­"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["AWS","SES","LocalStack"]
published: false
---

https://github.com/localstack/localstack/blob/master/docker-compose.yml ã‚’å‚è€ƒã« docker-compose.yml ã‚’ä½œã£ã¦å®Ÿè¡Œã™ã‚‹ã€‚

```yml
version: "3.8"

services:
  localstack:
    container_name: "${LOCALSTACK_DOCKER_NAME-localstack_main}"
    image: localstack/localstack
    ports:
      - "127.0.0.1:4566:4566"            # LocalStack Gateway
    environment:
      - DEBUG=${DEBUG-}
      - PERSISTENCE=${PERSISTENCE-}
      - LAMBDA_EXECUTOR=${LAMBDA_EXECUTOR-}
      - DOCKER_HOST=unix:///var/run/docker.sock
    volumes:
      - "${LOCALSTACK_VOLUME_DIR:-./volume}:/var/lib/localstack"
      - "/var/run/docker.sock:/var/run/docker.sock"
```

```sh
docker compose up -d
```

ãƒ‰ãƒ¡ã‚¤ãƒ³èªè¨¼ã¨ã‹ã—ã¦ã„ãªã„ã‘ã©ã€ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã‚’è©¦ã¿ã‚‹ã€‚

```sh
aws ses send-email \
--endpoint-url http://localhost:4566 \
--from beats@example.com \
--to beats-r@example.com \
--subject subject \
--text body

An error occurred (MessageRejected) when calling the SendEmail operation: Email address not verified beats@example.com
```

LocalStackã ã‹ã‚‰ã¨ã„ã£ã¦èªè¨¼ãŒã„ã‚‰ãªã„ãªã‚“ã¦ã“ã¨ã¯ç„¡ã‹ã£ãŸã€‚

ãƒ‰ãƒ¡ã‚¤ãƒ³æ¤œè¨¼ä½œæ¥­ã‚’é–‹å§‹ğŸš€

```sh
aws ses verify-domain-identity \
--endpoint-url http://localhost:4566 \
--domain "example.com"
```

ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’ç¢ºèªğŸ–‹

```sh
aws ses get-identity-verification-attributes \
--endpoint-url http://localhost:4566 \
--identities "example.com"
{
    "VerificationAttributes": {
        "example.com": {
            "VerificationStatus": "Success",
            "VerificationToken": "cd7d40d3-2aa9-4c8a-a095-5fbe837a5ff0"
        }
    }
}
```

ç„¡äº‹æ¤œè¨¼æˆåŠŸã—ã¦ã„ãŸã®ã§ã€å†åº¦ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã—ã¦ã¿ã‚‹ã€‚
APIå‘¼ã³å‡ºã—ã¯æˆåŠŸã—ãŸã‘ã©ã€å¾…ã¦ã©æš®ã‚‰ã›ã©ãƒ¡ãƒ¼ãƒ«ã¯å±Šã‹ãªã„ã€‚

```sh
aws ses verify-email-identity \
--endpoint-url http://localhost:4566 \
--email-address beats-r@example.com
```


