---
title: "ã€Notion/Goã€‘Go ã§ Notion API ã‚’è©¦ã—ã¦ã¿ã‚‹"
emoji: "ğŸ‘Š"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Notion","NotionAPI","Go"]
published: true
---

2021å¹´5æœˆ14æ—¥ã« Notion API ã®ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ™ãƒ¼ã‚¿ç‰ˆãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¾ã—ãŸã€‚
Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚„CLIç­‰ã¨ Notion ã‚’é€£æºã•ã›ã¦ã¿ãŸã„ãªãƒ¼ãªã‚“ã¦æ€ã£ãŸã‚Šã—ã¦ã„ã¾ã™ã€‚
ã¨ã‚Šã‚ãˆãšã©ã‚“ãªã“ã¨ãŒå‡ºæ¥ã‚‹ã®ã‹è©¦ã—ãŸã‹ã£ãŸã®ã§ã€Go ã§ Notion API ã‚’ä½¿ã£ãŸãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ã„ã¦ã¿ã¾ã—ãŸã€‚
æ—¢ã« GitHub ã«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒã„ãã¤ã‹å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã®ã§ã™ãŒã€ä»Šå›ã¯æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã¿ã‚’ä½¿ã£ã¦ã„ãã¾ã™ã€‚

## ç’°å¢ƒ

- go1.16.5
- macOS Catalina 10.17.7

## Notionå´ã®è¨­å®š

å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚è€ƒã«Notionå´ã®æº–å‚™ã‚’ã—ã¦ã„ãã¾ã™ã€‚
https://developers.notion.com/docs

### integrationä½œæˆ

ã¾ãšã¯integrationãªã‚‹ã‚‚ã®ã‚’ä½œæˆã—ã€ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã¨ç´ä»˜ã‘ã¾ã™ã€‚

ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã¯ã€

> Integrations built with the API follow a similar permission system to the sharing permissions for users. There's an important difference: integrations don't have access to any pages (or databases) in the workspace at first. A user must share specific pages with an integration in order for those pages to be accessed using the API. This helps keep you and your team's information in Notion secure.


ã¨ã‚ã‚Šã€ä½œæˆã—ãŸãƒšãƒ¼ã‚¸ã‚’integrationã«shareã™ã‚‹ã“ã¨ã§ã€ãã®ãƒšãƒ¼ã‚¸ã®APIæ“ä½œãŒå¯èƒ½ã«ãªã‚‹ã‚ˆã†ã§ã™ã€‚

integrationã¯Webç‰ˆã§ã®ä½œæˆã¨ãªã‚‹ã®ã§ã€https://www.notion.so/my-integrations ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚
æ³¨æ„ç‚¹ã¨ã—ã¦integrationä½œæˆæ™‚ã¯ Notion ã«Adminã§ãƒ­ã‚°ã‚¤ãƒ³ã—ãªã‘ã‚Œã°ã„ã‘ã¾ã›ã‚“ã€‚
Adminæ¨©é™ãŒãªã„å ´åˆã¯integrationã«ç´ä»˜ã‘ã‚‰ã‚Œã‚‹ã®ã¯å€‹äººãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®ã¿ã¨ãªã‚Šã¾ã™ã€‚
ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ãŒã§ããŸã‚‰ã€ç”»é¢ã® **New integration** ã‚’æŠ¼ä¸‹ã—ã¾ã™ã€‚
ç¶šã„ã¦integrationåã€logoã€ç´ä»˜ã‘ã‚‹ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã‚’è¨­å®šã— **Submit** ã‚’æŠ¼ä¸‹ã™ã‚‹ã“ã¨ã§ä½œæˆã¯å®Œäº†ã§ã™ã€‚
é·ç§»å¾Œã®ç”»é¢ã®Secretsã¯ã€APIä½¿ç”¨æ™‚ã«ãƒˆãƒ¼ã‚¯ãƒ³ã¨ã—ã¦å¿…è¦ã«ãªã‚Šã¾ã™ã€‚
ã¾ãŸã€Integration typeã‚’é¸æŠã™ã‚‹ã“ã¨ã§integrationã®å…¬é–‹ã€éå…¬é–‹ã®è¨­å®šãŒã§ãã¾ã™ã€‚

### ãƒšãƒ¼ã‚¸ã®share

APIçµŒç”±ã§æ“ä½œã—ãŸã„ãƒšãƒ¼ã‚¸ã‚’integrartionã«shareã—ã¾ã™ã€‚
ãƒšãƒ¼ã‚¸ã®å³ä¸Šã®**share**ã‚’æŠ¼ä¸‹ã™ã‚‹ã¨ã€ãƒ¢ãƒ¼ãƒ€ãƒ«ãŒè¡¨ç¤ºã•ã‚ŒintegrationãŒé¸æŠã§ãã¾ã™ã€‚
å…ˆã»ã©ä½œæˆã—ãŸintegrationã‚’é¸æŠã—ã€**invite**ã‚’æŠ¼ä¸‹ã—ã¾ã™ã€‚
ã¾ãŸãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®ãƒ¡ãƒ³ãƒãƒ¼ã§ã‚ã‚Œã°ã€adminãƒ¦ãƒ¼ã‚¶ä»¥å¤–ã®ãƒ¦ãƒ¼ã‚¶ã§ã‚‚ã“ã®æ“ä½œã¯å¯èƒ½ã§ã™ã€‚

ä»Šå›ã¯ãƒšãƒ¼ã‚¸åã®ã¿ä»˜ã‘ãŸç©ºã£ã½ã®ãƒšãƒ¼ã‚¸ã‚’integrationã«shareã—ã¾ã—ãŸã€‚

![](https://storage.googleapis.com/zenn-user-upload/eb5dcd92bb75c9e0d3d83190.png)

## APIã®ä½¿ç”¨

ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚è€ƒã«é€²ã‚ã¦ã„ãã¾ã™ã€‚
https://developers.notion.com/reference/intro

### ãƒšãƒ¼ã‚¸ã®å–å¾—

integrationã«shareã—ãŸãƒšãƒ¼ã‚¸ã‚’å–å¾—ã—ã¾ã™ã€‚
ãƒšãƒ¼ã‚¸ã®IDã€API KEYãŒæƒã£ã¦ã„ã‚Œã°å–å¾—å¯èƒ½ã§ã™ã€‚
ãªãŠãƒšãƒ¼ã‚¸ã®IDã¯ã€ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹éš›ã®URLã®æœ«å°¾ã®ã‚‚ã®ã«ã‚ãŸã‚Šã€APIä½¿ç”¨æ™‚ã«ã¯`-`ã‚’å…¥ã‚Œã¦UUIDã®å½¢å¼ã§æ‰±ã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```go
const ApiKey = "APIã®Key"

func main() {
	client := &http.Client{}
	req, err := http.NewRequest("GET", "https://api.notion.com/v1/pages/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", nil)
	if err != nil {
		log.Fatal(err)
	}
	req.Header.Add("Authorization", "Bearer" + ApiKey)
	req.Header.Add("Notion-Version", "2021-05-13")
	resp, err := client.Do(req)
	if err != nil {
		log.Fatal(err)
	}
	defer resp.Body.Close()
	b, err := io.ReadAll(resp.Body)
	if err != nil {
		log.Fatal(err)
	}
	var out bytes.Buffer
	json.Indent(&out, b, "", "  ")
	out.WriteTo(os.Stdout)
}
```

```sh
$ go run main.go
{
  "object": "page",
  "id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "created_time": "2021-06-05T06:13:00.000Z",
  "last_edited_time": "2021-06-06T01:39:00.000Z",
  "parent": {
    "type": "workspace",
    "workspace": true
  },
  "archived": false,
  "properties": {
    "title": {
      "id": "title",
      "type": "title",
      "title": [
        {
          "type": "text",
          "text": {
            "content": "Sample",
            "link": null
          },
          "annotations": {
            "bold": false,
            "italic": false,
            "strikethrough": false,
            "underline": false,
            "code": false,
            "color": "default"
          },
          "plain_text": "Sample",
          "href": null
        }
      ]
    }
  }
}
```

### ãƒšãƒ¼ã‚¸ã®ä½œæˆ

ãŒã‚“ãŒã‚“ãƒšãƒ¼ã‚¸ã‚’ä½œæˆã—ã¦ã„ã“ã†ã¨æ€ã„ã¾ã—ãŸãŒã€ä½œæˆæ™‚ã«`parent`(ä¸€ã¤ã®ä¸Šã®éšå±¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ)ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ç‚ºã€APIçµŒç”±ã ã¨ãƒšãƒ¼ã‚¸ã‚’ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ç›´ä¸‹ã«ã¯ä½œæˆã§ããªã„ã¨æ°—ä»˜ãã¾ã—ãŸã€‚
ã¤ã¾ã‚Šintegrationã«shareã—ãŸãƒšãƒ¼ã‚¸ã€ãã®ãƒšãƒ¼ã‚¸ã‚ˆã‚Šä¸‹ã®éšå±¤ã‚‚ã®ã—ã‹æ“ä½œã§ããªã„ã¨ã„ã†ã“ã¨ã§ã™ã€‚
ãã‚‰ãã†ã‹ã€ã¨ã„ã†æ„Ÿã˜ã§ã™ã€‚

ãƒšãƒ¼ã‚¸ã¯`Page object`ã«ã‚ˆã£ã¦æ§‹æˆã•ã‚Œã€`Page object`ã¯ãƒšãƒ¼ã‚¸ã«é–¢ã™ã‚‹æƒ…å ±(ã‚¿ã‚¤ãƒˆãƒ«ãªã©)ã¨ã—ã¦`properties`ã‚’æŒã£ã¦ã„ã¾ã™ã€‚
ã¾ãŸã€ãƒšãƒ¼ã‚¸ä½œæˆæ™‚ã«`children`ã‚’å®šç¾©ã—ã¦ãƒœãƒ‡ã‚£ã«å«ã‚ã‚‹ã“ã¨ã§ãƒšãƒ¼ã‚¸ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ä½œæˆã§ãã¾ã™ã€‚
`children`ã«è¦‹å‡ºã—ã¨æ®µè½ã‚’å®šç¾©ã—ã¦ã¿ã¾ã™ã€‚
`parent`ã«ã¯integrationã«shareã—ãŸãƒšãƒ¼ã‚¸ã‚’æŒ‡å®šã—ã¾ã™ã€‚

```json:input.json
{
  "parent": {
    "page_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
  },
  "properties": {
    "title": {
      "title": [
      	{
      	  "text": {
      	    "content": "Title"
      	  }
      	}
      ]
    }
  },
  "children": [
    {
      "object": "block",
      "type": "heading_2",
      "heading_2": {
        "text": [
          {
            "type": "text",
            "text": {
              "content": "è¦‹å‡ºã—ã§ã™"
            }
          }
        ]
      }
    },
    {
      "object": "block",
      "type": "paragraph",
      "paragraph": {
        "text": [
          {
            "type": "text",
            "text": {
              "content": "æ®µè½ã§ã™"
            }
          }
        ]
      }
    }
  ]
}
```

```go
const ApiKey = "APIã®Key"

func main() {
	client := &http.Client{}
	jsonBody, err := ioutil.ReadFile("input.json")
	if err != nil {
		log.Fatal(err)
	}
	body := strings.NewReader(string(jsonBody))
	req, err := http.NewRequest("POST", "https://api.notion.com/v1/pages", body)
	if err != nil {
		log.Fatal(err)
	}
	req.Header.Add("Authorization", "Bearer " + ApiKey)
	req.Header.Add("Notion-Version", "2021-05-13")
	req.Header.Add("Content-Type", "application/json")
	resp, err := client.Do(req)
	if err != nil {
		log.Fatal(err)
	}
	defer resp.Body.Close()
	b, err := io.ReadAll(resp.Body)
	if err != nil {
		log.Fatal(err)
	}
	var out bytes.Buffer
	json.Indent(&out, b, "", "  ")
	out.WriteTo(os.Stdout)
}
```

```sh
$ go run main.go
{
  "object": "page",
  "id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "created_time": "2021-06-06T01:50:11.022Z",
  "last_edited_time": "2021-06-06T01:50:11.023Z",
  "parent": {
    "type": "page_id",
    "page_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
  },
  "archived": false,
  "properties": {
    "title": {
      "id": "title",
      "type": "title",
      "title": [
        {
          "type": "text",
          "text": {
            "content": "Title",
            "link": null
          },
          "annotations": {
            "bold": false,
            "italic": false,
            "strikethrough": false,
            "underline": false,
            "code": false,
            "color": "default"
          },
          "plain_text": "Title",
          "href": null
        }
      ]
    }
  }
}
```

![](https://storage.googleapis.com/zenn-user-upload/8e074586c21037ebab086177.png)
![](https://storage.googleapis.com/zenn-user-upload/5c1f9f1a69291bed33779cf9.png)

æƒ³å®šé€šã‚Šä½œæˆã•ã‚Œã¦ã„ã¾ã™ã€‚

### ãƒšãƒ¼ã‚¸ã®æ›´æ–°

ãƒšãƒ¼ã‚¸ã¯ã„ãã¤ã‹ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æŒã£ã¦ãŠã‚Šã€æ›´æ–°ãŒå¯èƒ½ã§ã™ã€‚
ã‚¿ã‚¤ãƒˆãƒ«ã‚’å¤‰æ›´ã—ã€ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’è¿½åŠ ã—ã¦ã¿ã¾ã™ã€‚
ãƒ‘ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒšãƒ¼ã‚¸ã®IDã«ã¯å…ˆã»ã©ä½œæˆã—ãŸãƒšãƒ¼ã‚¸ã®IDã‚’å…¥ã‚Œã¾ã™ã€‚

```json:input.json
{
  "properties": {
    "title": {
      "title": [
        {
          "text": {
            "content": "Updated Title"
          }
        }
      ]
    }
  }
}
```

```go
const ApiKey = "APIã®Key"

func main() {
	client := &http.Client{}
	jsonBody, err := ioutil.ReadFile("input.json")
	if err != nil {
		log.Fatal(err)
	}
	body := strings.NewReader(string(jsonBody))
	req, err := http.NewRequest("PATCH", "https://api.notion.com/v1/pages/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx", body)
	if err != nil {
		log.Fatal(err)
	}
	req.Header.Add("Authorization", "Bearer" + ApiKey)
	req.Header.Add("Notion-Version", "2021-05-13")
	req.Header.Add("Content-Type", "application/json")
	resp, err := client.Do(req)
	if err != nil {
		log.Fatal(err)
	}
	defer resp.Body.Close()
	b, err := io.ReadAll(resp.Body)
	if err != nil {
		log.Fatal(err)
	}
	var out bytes.Buffer
	json.Indent(&out, b, "", "  ")
	out.WriteTo(os.Stdout)
}
```

```
$ go run main.go
{
  "object": "page",
  "id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "created_time": "2021-06-06T01:50:11.022Z",
  "last_edited_time": "2021-06-06T01:54:19.397Z",
  "parent": {
    "type": "page_id",
    "page_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
  },
  "archived": false,
  "properties": {
    "title": {
      "id": "title",
      "type": "title",
      "title": [
        {
          "type": "text",
          "text": {
            "content": "Updated Title",
            "link": null
          },
          "annotations": {
            "bold": false,
            "italic": false,
            "strikethrough": false,
            "underline": false,
            "code": false,
            "color": "default"
          },
          "plain_text": "Updated Title",
          "href": null
        }
      ]
    }
  }
}
```

![](https://storage.googleapis.com/zenn-user-upload/e1444563666f52458c9adcb4.png)

æƒ³å®šé€šã‚Šå¤‰æ›´ã•ã‚Œã¦ã„ã¾ã™ã€‚

## ã•ã„ã”ã«

ä»Šå›ã¯ã²ã¨ã¾ãšãƒšãƒ¼ã‚¸ã®æ“ä½œã‚’è©¦ã—ã¦ã¿ã¾ã—ãŸã€‚
ä»–ã«ã‚‚ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚„ãƒ¦ãƒ¼ã‚¶ã®æ“ä½œãªã©ã®APIã‚‚å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚
ã“ã‚Œã‹ã‚‰ã©ã‚“ã©ã‚“APIãŒè¿½åŠ ã•ã‚Œã¦ã„ãã®ãŒæ¥½ã—ã¿ã§ã™ã€‚

ã¾ãŸã€ Go ã§HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’å®Ÿè£…ã™ã‚‹ã®ãŒæ¥½ã—ã‹ã£ãŸã®ã§ã€ã„ã‚ã‚“ãªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå®Ÿè£…ã—ã¦ã¿ãŸã„ãªãªã‚“ã¦æ€ã„ã¾ã—ãŸã€‚